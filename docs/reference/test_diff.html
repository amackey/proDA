<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify significant coefficients — test_diff • proDA</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Identify significant coefficients — test_diff" />

<meta property="og:description" content="The function is used to test coefficients of a 'proDAFit'
object. It provides a Wald test to test individual
coefficients and a likelihood ratio F-test to compare the
original model with a reduced model. The result_names
method provides a quick overview which coefficients are
available for testing." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">proDA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/const-ae/proDA">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify significant coefficients</h1>
    <small class="dont-index">Source: <a href='https://github.com/const-ae/proDA/blob/master/R/test_diff.R'><code>R/test_diff.R</code></a></small>
    <div class="hidden name"><code>test_diff.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function is used to test coefficients of a 'proDAFit'
object. It provides a Wald test to test individual
coefficients and a likelihood ratio F-test to compare the
original model with a reduced model. The <code>result_names</code>
method provides a quick overview which coefficients are
available for testing.</p>
    
    </div>

    <pre class="usage"><span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='no'>contrast</span>, <span class='kw'>reduced_model</span> <span class='kw'>=</span> ~<span class='fl'>1</span>,
  <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"two.sided"</span>, <span class='st'>"greater"</span>, <span class='st'>"less"</span>),
  <span class='kw'>pval_adjust_method</span> <span class='kw'>=</span> <span class='st'>"BH"</span>, <span class='kw'>sort_by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>n_max</span> <span class='kw'>=</span> <span class='fl'>Inf</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S4 method for proDAFit</span>
<span class='fu'><a href='result_names.html'>result_names</a></span>(<span class='no'>fit</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit</th>
      <td><p>an object of class 'proDAFit'. Usually, this is
produced by calling <code><a href='proDA.html'>proDA()</a></code></p></td>
    </tr>
    <tr>
      <th>contrast</th>
      <td><p>an expression or a string specifying which
contrast is tested. It can be a single coefficient (to see
the available options use <code><a href='result_names.html'>result_names(fit)</a></code>) or any
linear combination of them. The contrast is always compared
against zero. Thus, to find out if two coefficients differ
use <code>coef1 - coef2</code>.</p></td>
    </tr>
    <tr>
      <th>reduced_model</th>
      <td><p>The fit with an alternative model (nested
in the original model) is compared with the original model
using an F-test. This is useful if not just an individual
coefficient should be tested, but the effect of including
a combination of covariates. If neither a <code>contrast</code>, nor
a <code>reduced_model</code> is specified, by default a comparison
with an intercept model is done. Default: <code>~ 1</code>.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>a string that decides how the
hypothesis test is done. This parameter is only relevant for
the t-test / contrast test. Default: <code>"two.sided"</code></p></td>
    </tr>
    <tr>
      <th>pval_adjust_method</th>
      <td><p>a string the indicates the method
that is used to adjust the p-value for the multiple testing.
It must match the options in <code><a href='https://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust.methods</a></code>.
Default: <code>"BH"</code></p></td>
    </tr>
    <tr>
      <th>sort_by</th>
      <td><p>a string that specifies the column that is used
to sort the resulting data.frame. Default: <code>NULL</code> which
means the result is sorted by the order of the input matrix.</p></td>
    </tr>
    <tr>
      <th>decreasing</th>
      <td><p>a boolean to indicate if the order is reversed.
Default: <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>n_max</th>
      <td><p>the maximum number of rows returned by the method.
Default: <code>Inf</code></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>boolean that signals if the method prints informative
messages. Default: <code>FALSE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Both functions return a <code>data.frame</code> with one row per protein
  with the key parameters of the statistical test.</p>
<p>The Wald test, which can considered equivalent to a t-test, returns
  a data.frame with the following columns:</p><dl class='dl-horizontal'>
    <dt>name</dt><dd><p>the name of the protein, extracted from the rowname of
      the input matrix</p></dd>
    <dt>pval</dt><dd><p>the p-value of the statistical test</p></dd>
    <dt>adj_pval</dt><dd><p>the multiple testing adjusted p-value</p></dd>
    <dt>diff</dt><dd><p>the difference that particular coefficient makes. In
      differential expression analysis this value is also called
      log fold change, which is equivalent to the difference on the
      log scale.</p></dd>
    <dt>t_statistic</dt><dd><p>the <code>diff</code> divided by the standard
      error <code>se</code></p></dd>
    <dt>se</dt><dd><p>the standard error associated with the <code>diff</code></p></dd>
    <dt>df</dt><dd><p>the degrees of freedom, which describe the amount
      of available information for estimating the <code>se</code>. They
      are the sum of the number of samples the protein was observed
      in, the amount of information contained in the missing values,
      and the estimated df from the variance prior.</p></dd>
    <dt>avg_abundance</dt><dd><p>the estimate of the average abundance of
      the protein across all samples.</p></dd>
    <dt>n_approx</dt><dd><p>the approximated information available for estimating
      the protein features, expressed as multiple of the information
      contained in one observed value.</p></dd>
    <dt>n_obs</dt><dd><p>the number of samples a protein was observed in</p></dd>
  </dl>

<p><br /><br />
  The F-test returns a data.frame with the following columns</p><dl class='dl-horizontal'>
    <dt>name</dt><dd><p>the name of the protein, extracted from the rowname of
      the input matrix</p></dd>
    <dt>pval</dt><dd><p>the p-value of the statistical test</p></dd>
    <dt>adj_pval</dt><dd><p>the multiple testing adjusted p-value</p></dd>
    <dt>f_statistic</dt><dd><p>the ratio of difference of normalized deviances
     from original model and the reduced model, divided by the
     standard deviation.</p></dd>
    <dt>df1</dt><dd><p>the difference of the number of coefficients in the
      original model and the number of coefficients in the reduced
      model</p></dd>
    <dt>df2</dt><dd><p>the degrees of freedom, which describe the amount
      of available information for estimating the <code>se</code>. They
      are the sum of the number of samples the protein was observed
      in, the amount of information contained in the missing values,
      and the estimated df from the variance prior.</p></dd>
    <dt>avg_abundance</dt><dd><p>the estimate of the average abundance of
      the protein across all samples.</p></dd>
    <dt>n_approx</dt><dd><p>the information available for estimating
      the protein features, expressed as multiple of the information
      contained in one observed value.</p></dd>
    <dt>n_obs</dt><dd><p>the number of samples a protein was observed in</p></dd>
  </dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To test if coefficient is different from zero with a Wald
test use the <code>contrast</code> function argument. To test if two
models differ with an F-test use the <code>reduced_model</code>
argument. Depending on the test that is conducted, the functions
returns slightly different data.frames.</p>
<p>The function is designed to follow the principles of the
base R test functions (ie. <code><a href='https://www.rdocumentation.org/packages/stats/topics/t.test'>t.test</a></code> and
<code><a href='https://www.rdocumentation.org/packages/stats/topics/wilcox.test'>wilcox.test</a></code>) and the functions designed
for collecting the results of high-throughput  testing
(ie. <code><a href='https://www.rdocumentation.org/packages/limma/topics/toptable'>limma::topTable</a></code> and <code><a href='https://www.rdocumentation.org/packages/DESeq2/topics/results'>DESeq2::results</a></code>).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The contrast argument is inspired by
  <code><a href='https://www.rdocumentation.org/packages/limma/topics/makeContrasts'>limma::makeContrasts</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  <span class='co'># "t-test"</span>
  <span class='no'>syn_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_synthetic_data.html'>generate_synthetic_data</a></span>(<span class='kw'>n_proteins</span> <span class='kw'>=</span> <span class='fl'>10</span>)
  <span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='proDA.html'>proDA</a></span>(<span class='no'>syn_data</span>$<span class='no'>Y</span>, <span class='kw'>design</span> <span class='kw'>=</span> <span class='no'>syn_data</span>$<span class='no'>groups</span>)
  <span class='fu'><a href='result_names.html'>result_names</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; [1] "Condition_1" "Condition_2"</div><div class='input'>  <span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='no'>Condition_1</span> - <span class='no'>Condition_2</span>)</div><div class='output co'>#&gt;          name      pval  adj_pval         diff  t_statistic        se  df
#&gt; 1   protein_1 0.9943172 0.9943172 -0.004462424 -0.007122347 0.6265384 Inf
#&gt; 2   protein_2 0.6856990 0.9943172  0.252917181  0.404698682 0.6249518 Inf
#&gt; 3   protein_3 0.6631704 0.9943172 -0.266073335 -0.435540198 0.6109042 Inf
#&gt; 4   protein_4 0.7104590 0.9943172 -0.247763006 -0.371239648 0.6673937 Inf
#&gt; 5   protein_5 0.6318757 0.9943172  0.373792089  0.479088435 0.7802152 Inf
#&gt; 6   protein_6 0.8405586 0.9943172 -0.125649592 -0.201178991 0.6245662 Inf
#&gt; 7   protein_7 0.7943413 0.9943172 -0.238312682 -0.260677355 0.9142055 Inf
#&gt; 8   protein_8 0.9052005 0.9943172  0.079842606  0.119094463 0.6704141 Inf
#&gt; 9   protein_9 0.3870191 0.9943172 -0.574924429 -0.865035816 0.6646250 Inf
#&gt; 10 protein_10 0.7369086 0.9943172 -0.419254855 -0.335949981 1.2479681 Inf
#&gt;    avg_abundance n_approx n_obs
#&gt; 1       21.42860 6.000002     6
#&gt; 2       21.28680 6.000000     6
#&gt; 3       20.18215 6.000000     6
#&gt; 4       19.32293 4.975093     5
#&gt; 5       18.89834 3.777090     4
#&gt; 6       21.24898 6.000000     6
#&gt; 7       17.86231 3.129577     2
#&gt; 8       20.43527 4.816353     5
#&gt; 9       18.99253 4.081410     4
#&gt; 10      17.17630 2.932776     2</div><div class='input'>

  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/message'>suppressPackageStartupMessages</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SummarizedExperiment</span>))
  <span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_synthetic_data.html'>generate_synthetic_data</a></span>(<span class='kw'>n_proteins</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                                <span class='kw'>n_conditions</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                                <span class='kw'>return_summarized_experiment</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>se</span>)$<span class='no'>age</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>9</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>5</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>se</span>)</div><div class='output co'>#&gt; DataFrame with 9 rows and 4 columns
#&gt;                     group true_dropout_curve_position true_dropout_curve_scale
#&gt;                  &lt;factor&gt;                   &lt;numeric&gt;                &lt;numeric&gt;
#&gt; Condition_1-1 Condition_1                        18.5                     -1.2
#&gt; Condition_1-2 Condition_1                        18.5                     -1.2
#&gt; Condition_1-3 Condition_1                        18.5                     -1.2
#&gt; Condition_2-1 Condition_2                        18.5                     -1.2
#&gt; Condition_2-2 Condition_2                        18.5                     -1.2
#&gt; Condition_2-3 Condition_2                        18.5                     -1.2
#&gt; Condition_3-1 Condition_3                        18.5                     -1.2
#&gt; Condition_3-2 Condition_3                        18.5                     -1.2
#&gt; Condition_3-3 Condition_3                        18.5                     -1.2
#&gt;                            age
#&gt;                      &lt;numeric&gt;
#&gt; Condition_1-1 53.8179317387294
#&gt; Condition_1-2 48.4480011096705
#&gt; Condition_1-3 39.4962967778804
#&gt; Condition_2-1 48.5725467844891
#&gt; Condition_2-2 43.7676484153299
#&gt; Condition_2-3  43.401069170364
#&gt; Condition_3-1 51.8132214647735
#&gt; Condition_3-2 38.8605870500866
#&gt; Condition_3-3 42.4439038362476</div><div class='input'>  <span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='proDA.html'>proDA</a></span>(<span class='no'>se</span>, <span class='kw'>design</span> <span class='kw'>=</span> ~ <span class='no'>group</span> + <span class='no'>age</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Dropout curve estimation did not properly converge</span></div><div class='input'>  <span class='fu'><a href='result_names.html'>result_names</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; [1] "Intercept"        "groupCondition_2" "groupCondition_3" "age"             </div><div class='input'>  <span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='st'>"groupCondition_2"</span>,
            <span class='kw'>n_max</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>sort_by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>)</div><div class='output co'>#&gt;          name         pval     adj_pval       diff t_statistic        se
#&gt; 10 protein_10 6.635730e-06 0.0000663573 -4.3994247  -12.343730 0.3564097
#&gt; 2   protein_2 4.084391e-02 0.2042195485  0.8927792    2.518773 0.3544501
#&gt; 5   protein_5 2.806670e-01 0.7059323978  0.4434504    1.229442 0.3606924
#&gt;          df avg_abundance n_approx n_obs
#&gt; 10 6.798832      25.85982 9.000000     9
#&gt; 2  6.798832      20.75867 9.000000     9
#&gt; 5  4.392250      19.62519 6.593418     7</div><div class='input'>
  <span class='co'># F-test</span>
  <span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='kw'>reduced_model</span> <span class='kw'>=</span> ~ <span class='no'>group</span>)</div><div class='output co'>#&gt;          name       pval  adj_pval f_statistic df1      df2 avg_abundance
#&gt; 1   protein_1 1.00000000 1.0000000 -0.31474344   1 0.001000      16.92693
#&gt; 2   protein_2 0.06862109 0.6862109  4.67129542   1 6.798832      20.75867
#&gt; 3   protein_3 0.14932680 0.7466340  2.76683689   1 5.763133      20.18251
#&gt; 4   protein_4 0.52478137 1.0000000  0.44928160   1 6.798832      22.45078
#&gt; 5   protein_5 1.00000000 1.0000000 -0.04919088   1 4.392250      19.62519
#&gt; 6   protein_6 0.81907578 1.0000000  0.05652795   1 6.798832      19.23328
#&gt; 7   protein_7 0.41248562 1.0000000  1.24914569   1 1.483953      17.60181
#&gt; 8   protein_8 1.00000000 1.0000000 -0.23746301   1 2.358127      18.90052
#&gt; 9   protein_9 0.86831471 1.0000000  0.03058988   1 4.786377      19.23185
#&gt; 10 protein_10 0.61189929 1.0000000  0.28263459   1 6.798832      25.85982
#&gt;    n_approx n_obs
#&gt; 1  4.001000     1
#&gt; 2  9.000000     9
#&gt; 3  7.964301     8
#&gt; 4  9.000000     9
#&gt; 5  6.593418     7
#&gt; 6  9.000000     9
#&gt; 7  3.685121     3
#&gt; 8  4.559295     4
#&gt; 9  6.987545     7
#&gt; 10 9.000000     9</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Constantin Ahlmann-Eltze.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

