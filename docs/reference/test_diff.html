<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify differentially abundant proteins — test_diff • proDA</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Identify differentially abundant proteins — test_diff" />

<meta property="og:description" content="The `test_diff()` function is used to test coefficients of a 'proDAFit'
object. It provides a Wald test to test individual
coefficients and a likelihood ratio F-test to compare the
original model with a reduced model. The result_names
method provides a quick overview which coefficients are
available for testing." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">proDA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.99.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/data-import.html">Proteomics Data Import</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/const-ae/proDA">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify differentially abundant proteins</h1>
    <small class="dont-index">Source: <a href='https://github.com/const-ae/proDA/blob/master/R/test_diff.R'><code>R/test_diff.R</code></a></small>
    <div class="hidden name"><code>test_diff.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The `test_diff()` function is used to test coefficients of a 'proDAFit'
object. It provides a Wald test to test individual
coefficients and a likelihood ratio F-test to compare the
original model with a reduced model. The <code>result_names</code>
method provides a quick overview which coefficients are
available for testing.</p>
    
    </div>

    <pre class="usage"><span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='no'>contrast</span>, <span class='kw'>reduced_model</span> <span class='kw'>=</span> ~<span class='fl'>1</span>,
  <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"two.sided"</span>, <span class='st'>"greater"</span>, <span class='st'>"less"</span>),
  <span class='kw'>pval_adjust_method</span> <span class='kw'>=</span> <span class='st'>"BH"</span>, <span class='kw'>sort_by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>n_max</span> <span class='kw'>=</span> <span class='fl'>Inf</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S4 method for proDAFit</span>
<span class='fu'><a href='result_names.html'>result_names</a></span>(<span class='no'>fit</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit</th>
      <td><p>an object of class 'proDAFit'. Usually, this is
produced by calling <code><a href='proDA.html'>proDA()</a></code></p></td>
    </tr>
    <tr>
      <th>contrast</th>
      <td><p>an expression or a string specifying which
contrast is tested. It can be a single coefficient (to see
the available options use <code><a href='result_names.html'>result_names(fit)</a></code>) or any
linear combination of them. The contrast is always compared
against zero. Thus, to find out if two coefficients differ
use <code>coef1 - coef2</code>.</p></td>
    </tr>
    <tr>
      <th>reduced_model</th>
      <td><p>If you don't want to test an individual
coefficient, you can can specify a reduced model and compare
it with the original model using an F-test. This is useful
to find out how a set of parameters affect the goodness of
the fit. If neither a <code>contrast</code>, nor
a <code>reduced_model</code> is specified, by default a comparison
with an intercept model (ie. just the average across conditions)
is done. Default: <code>~ 1</code>.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>a string that decides how the
hypothesis test is done. This parameter is only relevant for
the Wald-test specified using the `contrast` argument.
Default: <code>"two.sided"</code></p></td>
    </tr>
    <tr>
      <th>pval_adjust_method</th>
      <td><p>a string the indicates the method
that is used to adjust the p-value for the multiple testing.
It must match the options in <code><a href='https://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust</a></code>.
Default: <code>"BH"</code></p></td>
    </tr>
    <tr>
      <th>sort_by</th>
      <td><p>a string that specifies the column that is used
to sort the resulting data.frame. Default: <code>NULL</code> which
means the result is sorted by the order of the input matrix.</p></td>
    </tr>
    <tr>
      <th>decreasing</th>
      <td><p>a boolean to indicate if the order is reversed.
Default: <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>n_max</th>
      <td><p>the maximum number of rows returned by the method.
Default: <code>Inf</code></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>boolean that signals if the method prints informative
messages. Default: <code>FALSE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The `result_names()` function returns a character vector.</p>
<p>The `test_diff()` function returns a <code>data.frame</code> with one row per protein
  with the key parameters of the statistical test. Depending what kind of test
  (Wald or F test) the content of the `data.frame` differs.</p>
<p>The Wald test, which can considered equivalent to a t-test, returns
  a `data.frame` with the following columns:</p><dl class='dl-horizontal'>
    <dt>name</dt><dd><p>the name of the protein, extracted from the rowname of
      the input matrix</p></dd>
    <dt>pval</dt><dd><p>the p-value of the statistical test</p></dd>
    <dt>adj_pval</dt><dd><p>the multiple testing adjusted p-value</p></dd>
    <dt>diff</dt><dd><p>the difference that particular coefficient makes. In
      differential expression analysis this value is also called
      log fold change, which is equivalent to the difference on the
      log scale.</p></dd>
    <dt>t_statistic</dt><dd><p>the <code>diff</code> divided by the standard
      error <code>se</code></p></dd>
    <dt>se</dt><dd><p>the standard error associated with the <code>diff</code></p></dd>
    <dt>df</dt><dd><p>the degrees of freedom, which describe the amount
      of available information for estimating the <code>se</code>. They
      are the sum of the number of samples the protein was observed
      in, the amount of information contained in the missing values,
      and the degrees of freedom of the variance prior.</p></dd>
    <dt>avg_abundance</dt><dd><p>the estimate of the average abundance of
      the protein across all samples.</p></dd>
    <dt>n_approx</dt><dd><p>the approximated information available for estimating
      the protein features, expressed as multiple of the information
      contained in one observed value.</p></dd>
    <dt>n_obs</dt><dd><p>the number of samples a protein was observed in</p></dd>
  </dl>


<p>The F-test returns a `data.frame` with the following columns</p><dl class='dl-horizontal'>
    <dt>name</dt><dd><p>the name of the protein, extracted from the rowname of
      the input matrix</p></dd>
    <dt>pval</dt><dd><p>the p-value of the statistical test</p></dd>
    <dt>adj_pval</dt><dd><p>the multiple testing adjusted p-value</p></dd>
    <dt>f_statistic</dt><dd><p>the ratio of difference of normalized deviances
     from original model and the reduced model, divided by the
     standard deviation.</p></dd>
    <dt>df1</dt><dd><p>the difference of the number of coefficients in the
      original model and the number of coefficients in the reduced
      model</p></dd>
    <dt>df2</dt><dd><p>the degrees of freedom, which describe the amount
      of available information for estimating the <code>se</code>. They
      are the sum of the number of samples the protein was observed
      in, the amount of information contained in the missing values,
      and the degrees of freedom of the variance prior.</p></dd>
    <dt>avg_abundance</dt><dd><p>the estimate of the average abundance of
      the protein across all samples.</p></dd>
    <dt>n_approx</dt><dd><p>the information available for estimating
      the protein features, expressed as multiple of the information
      contained in one observed value.</p></dd>
    <dt>n_obs</dt><dd><p>the number of samples a protein was observed in</p></dd>
  </dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To test if coefficient is different from zero with a Wald
test use the <code>contrast</code> function argument. To test if two
models differ with an F-test use the <code>reduced_model</code>
argument. Depending on the test that is conducted, the functions
returns slightly different data.frames.</p>
<p>The function is designed to follow the principles of the
base R test functions (ie. <code><a href='https://www.rdocumentation.org/packages/stats/topics/t.test'>t.test</a></code> and
<code><a href='https://www.rdocumentation.org/packages/stats/topics/wilcox.test'>wilcox.test</a></code>) and the functions designed
for collecting the results of high-throughput  testing
(ie. <code><a href='https://www.rdocumentation.org/packages/limma/topics/toptable'>limma::topTable</a></code> and <code><a href='https://www.rdocumentation.org/packages/DESeq2/topics/results'>DESeq2::results</a></code>).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The contrast argument is inspired by
  <code><a href='https://www.rdocumentation.org/packages/limma/topics/makeContrasts'>limma::makeContrasts</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  <span class='co'># "t-test"</span>
  <span class='no'>syn_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_synthetic_data.html'>generate_synthetic_data</a></span>(<span class='kw'>n_proteins</span> <span class='kw'>=</span> <span class='fl'>10</span>)
  <span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='proDA.html'>proDA</a></span>(<span class='no'>syn_data</span>$<span class='no'>Y</span>, <span class='kw'>design</span> <span class='kw'>=</span> <span class='no'>syn_data</span>$<span class='no'>groups</span>)
  <span class='fu'><a href='result_names.html'>result_names</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; [1] "Condition_1" "Condition_2"</div><div class='input'>  <span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='no'>Condition_1</span> - <span class='no'>Condition_2</span>)</div><div class='output co'>#&gt;          name       pval  adj_pval        diff t_statistic        se df
#&gt; 1   protein_1 0.63066796 0.8292043  0.13868715   0.5197612 0.2668286  4
#&gt; 2   protein_2 0.70057164 0.8292043 -0.09230335  -0.4133169 0.2233234  4
#&gt; 3   protein_3 0.02960657 0.1480328  1.17063438   3.3117272 0.3534815  4
#&gt; 4   protein_4 0.15879472 0.4800317  0.31384244   1.7293959 0.1814752  4
#&gt; 5   protein_5 0.82920433 0.8292043  0.05036218   0.2302352 0.2187423  4
#&gt; 6   protein_6 0.81128343 0.8292043  0.05249717   0.2550194 0.2058556  4
#&gt; 7   protein_7 0.19201270 0.4800317  0.23846547   1.5677433 0.1521075  4
#&gt; 8   protein_8 0.53561684 0.8292043 -0.14429122  -0.6768613 0.2131769  4
#&gt; 9   protein_9 0.72667595 0.8292043 -0.12732876  -0.3750301 0.3395161  4
#&gt; 10 protein_10 0.01098839 0.1098839 -0.81158997  -4.4801736 0.1811515  4
#&gt;    avg_abundance n_approx n_obs
#&gt; 1       18.22209 3.003094     3
#&gt; 2       20.00984 3.989574     4
#&gt; 3       17.52142 1.363857     1
#&gt; 4       21.28096 6.000000     6
#&gt; 5       21.21086 4.977908     5
#&gt; 6       19.59506 5.345718     5
#&gt; 7       23.08283 6.000000     6
#&gt; 8       19.06041 4.267228     4
#&gt; 9       20.00061 4.983345     5
#&gt; 10      23.52646 6.000000     6</div><div class='input'>

  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/message'>suppressPackageStartupMessages</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SummarizedExperiment</span>))
  <span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_synthetic_data.html'>generate_synthetic_data</a></span>(<span class='kw'>n_proteins</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                                <span class='kw'>n_conditions</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                                <span class='kw'>return_summarized_experiment</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>se</span>)$<span class='no'>age</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>9</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>5</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>se</span>)</div><div class='output co'>#&gt; DataFrame with 9 rows and 4 columns
#&gt;                     group true_dropout_curve_position true_dropout_curve_scale
#&gt;                  &lt;factor&gt;                   &lt;numeric&gt;                &lt;numeric&gt;
#&gt; Condition_1-1 Condition_1                        18.5                     -1.2
#&gt; Condition_1-2 Condition_1                        18.5                     -1.2
#&gt; Condition_1-3 Condition_1                        18.5                     -1.2
#&gt; Condition_2-1 Condition_2                        18.5                     -1.2
#&gt; Condition_2-2 Condition_2                        18.5                     -1.2
#&gt; Condition_2-3 Condition_2                        18.5                     -1.2
#&gt; Condition_3-1 Condition_3                        18.5                     -1.2
#&gt; Condition_3-2 Condition_3                        18.5                     -1.2
#&gt; Condition_3-3 Condition_3                        18.5                     -1.2
#&gt;                            age
#&gt;                      &lt;numeric&gt;
#&gt; Condition_1-1 45.4767700483905
#&gt; Condition_1-2 42.6859029002183
#&gt; Condition_1-3 37.6555892195272
#&gt; Condition_2-1 45.7634325276076
#&gt; Condition_2-2 53.8688130565859
#&gt; Condition_2-3 41.7596453324248
#&gt; Condition_3-1  44.000912621659
#&gt; Condition_3-2 48.4462186648859
#&gt; Condition_3-3  45.180727549183</div><div class='input'>  <span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='proDA.html'>proDA</a></span>(<span class='no'>se</span>, <span class='kw'>design</span> <span class='kw'>=</span> ~ <span class='no'>group</span> + <span class='no'>age</span>)
  <span class='fu'><a href='result_names.html'>result_names</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; [1] "Intercept"        "groupCondition_2" "groupCondition_3" "age"             </div><div class='input'>  <span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='st'>"groupCondition_2"</span>,
            <span class='kw'>n_max</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>sort_by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>)</div><div class='output co'>#&gt;          name       pval  adj_pval     diff t_statistic        se df
#&gt; 1   protein_1 0.05766252 0.3596771 1.186875    2.453854 0.4836778  5
#&gt; 10 protein_10 0.10541452 0.3596771 1.063993    1.973770 0.5390665  5
#&gt; 3   protein_3 0.10790314 0.3596771 1.296400    1.955533 0.6629396  5
#&gt;    avg_abundance n_approx n_obs
#&gt; 1       18.20726 2.643421     1
#&gt; 10      18.11640 4.664379     4
#&gt; 3       20.20987 8.362519     8</div><div class='input'>
  <span class='co'># F-test</span>
  <span class='fu'>test_diff</span>(<span class='no'>fit</span>, <span class='kw'>reduced_model</span> <span class='kw'>=</span> ~ <span class='no'>group</span>)</div><div class='output co'>#&gt;          name       pval  adj_pval  f_statistic df1      df2 avg_abundance
#&gt; 1   protein_1 0.83525553 0.9985119 5.159081e-02   1 2.926664      18.20726
#&gt; 2   protein_2 0.17019359 0.8509679 2.250220e+00   1 8.403543      20.07761
#&gt; 3   protein_3 0.08813637 0.8509679 3.693300e+00   1 8.645761      20.20987
#&gt; 4   protein_4 0.91314840 0.9985119 1.256128e-02   1 9.283242      23.16640
#&gt; 5   protein_5 0.63759269 0.9985119 2.371096e-01   1 9.283242      21.20843
#&gt; 6   protein_6 0.99851187 0.9985119 3.670676e-06   1 9.283242      22.53936
#&gt; 7   protein_7 0.41659423 0.9985119 7.228662e-01   1 9.283242      20.41743
#&gt; 8   protein_8 0.93818225 0.9985119 7.179518e-03   1 2.790716      18.39177
#&gt; 9   protein_9 0.65665475 0.9985119 2.190582e-01   1 5.861225      19.13118
#&gt; 10 protein_10 0.31029173 0.9985119 1.276726e+00   1 4.947621      18.11640
#&gt;    n_approx n_obs
#&gt; 1  2.643421     1
#&gt; 2  8.120301     8
#&gt; 3  8.362519     8
#&gt; 4  9.000000     9
#&gt; 5  9.000000     9
#&gt; 6  9.000000     9
#&gt; 7  9.000000     9
#&gt; 8  2.507474     1
#&gt; 9  5.577983     5
#&gt; 10 4.664379     4</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Constantin Ahlmann-Eltze.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

